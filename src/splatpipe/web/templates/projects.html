{% extends "base.html" %}
{% block title %}Projects â€” Splatpipe{% endblock %}

{% block content %}
<div class="flex justify-between items-center mb-6">
    <h1 class="text-3xl font-bold">Projects</h1>
    <a href="/projects/new" class="btn btn-primary btn-sm">+ New Project</a>
</div>

{% if projects %}
<div class="grid gap-4">
    {% for project in projects %}
    <a href="/projects/{{ project.path }}/detail" class="card bg-base-100 shadow-xl hover:bg-base-300 transition-colors">
        <div class="card-body py-4">
            <div class="flex items-center gap-4">
                <!-- Thumbnail -->
                <div class="flex-shrink-0 w-16 h-16 rounded-lg overflow-hidden bg-base-200 flex items-center justify-center">
                    {% if project.has_thumbnail %}
                    <img src="/projects/{{ project.path }}/thumbnail" class="w-full h-full object-cover" alt="">
                    {% else %}
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 opacity-20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                    </svg>
                    {% endif %}
                </div>
                <!-- Info -->
                <div class="flex-1 min-w-0">
                    <h2 class="card-title">{{ project.name }}</h2>
                    <p class="text-sm opacity-60">{{ project.trainer }} &middot; {{ project.lod_count }} LODs</p>
                </div>
                <!-- Step badges -->
                <div class="flex gap-2 flex-shrink-0">
                    {% for step_name in ['clean', 'train', 'assemble', 'export'] %}
                        {% set step = project.steps.get(step_name) %}
                        {% if step and step.status == 'completed' %}
                            <div class="badge badge-success">{{ step_name }}</div>
                        {% elif step and step.status == 'failed' %}
                            <div class="badge badge-error">{{ step_name }}</div>
                        {% elif step and step.status == 'running' %}
                            <div class="badge badge-warning">{{ step_name }}</div>
                        {% else %}
                            <div class="badge badge-ghost">{{ step_name }}</div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>
    </a>
    {% endfor %}
</div>
{% else %}
<div class="card bg-base-100 shadow-xl">
    <div class="card-body items-center text-center py-12">
        <h2 class="card-title text-2xl mb-2">No projects yet</h2>
        <p class="opacity-60 mb-4">Create your first project to get started.</p>
        <a href="/projects/new" class="btn btn-primary">+ New Project</a>
    </div>
</div>
{% endif %}
{% endblock %}
